{% extends "base.html" %}

{% block title %}Home - MaLDReTH Infrastructure Interactions{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <!-- Hero Section -->
        <div class="bg-primary text-white rounded p-5 mb-5">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-4 fw-bold mb-3">
                        <i class="bi bi-diagram-3 me-3"></i>
                        Infrastructure Interactions
                    </h1>
                    <p class="lead mb-4">
                        Collecting and managing potential infrastructure interactions 
                        for the MaLDReTH 2 Working Group meeting. Help us understand 
                        how research infrastructure components interact throughout 
                        the data lifecycle.
                    </p>
                    <div class="d-flex gap-3">
                        <a href="{{ url_for('add_interaction') }}" class="btn btn-light btn-lg">
                            <i class="bi bi-plus-circle me-2"></i>
                            Add Interaction
                        </a>
                        <a href="{{ url_for('view_interactions') }}" class="btn btn-outline-light btn-lg">
                            <i class="bi bi-list-ul me-2"></i>
                            View All ({{ interaction_count }})
                        </a>
                    </div>
                </div>
                <div class="col-md-4 text-center">
                    <i class="bi bi-arrow-left-right display-1 opacity-75"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mb-5">
    <!-- Statistics Cards -->
    <div class="col-md-3 mb-4">
        <div class="card border-primary">
            <div class="card-body text-center">
                <i class="bi bi-collection text-primary fs-1 mb-3"></i>
                <h3 class="card-title text-primary">{{ interaction_count }}</h3>
                <p class="card-text">Total Interactions</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card border-success">
            <div class="card-body text-center">
                <i class="bi bi-arrow-repeat text-success fs-1 mb-3"></i>
                <h3 class="card-title text-success">12</h3>
                <p class="card-text">Lifecycle Stages</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card border-info">
            <div class="card-body text-center">
                <i class="bi bi-diagram-2 text-info fs-1 mb-3"></i>
                <h3 class="card-title text-info">CSV</h3>
                <p class="card-text">
                    <a href="{{ url_for('export_csv') }}" class="btn btn-info btn-sm">
                        <i class="bi bi-download me-1"></i>Export Data
                    </a>
                </p>
            </div>
        </div>
    </div>
    
    <div class="col-md-3 mb-4">
        <div class="card border-warning">
            <div class="card-body text-center">
                <i class="bi bi-api text-warning fs-1 mb-3"></i>
                <h3 class="card-title text-warning">API</h3>
                <p class="card-text">
                    <a href="/api/interactions" class="btn btn-warning btn-sm" target="_blank">
                        <i class="bi bi-code me-1"></i>View API
                    </a>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Recent Interactions -->
{% if recent_interactions %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">
            <i class="bi bi-clock-history me-2"></i>
            Recent Interactions
        </h2>
        
        <div class="row">
            {% for interaction in recent_interactions %}
            <div class="col-lg-6 mb-3">
                <div class="card interaction-card h-100 
                    {% if interaction.priority == 'high' %}priority-high
                    {% elif interaction.priority == 'medium' %}priority-medium
                    {% else %}priority-low{% endif %}">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h5 class="card-title mb-0">
                                {{ interaction.interaction_type.replace('_', ' ').title() }}
                            </h5>
                            <span class="badge bg-secondary status-badge">
                                {{ interaction.status.title() }}
                            </span>
                        </div>
                        
                        <p class="card-text text-muted small mb-2">
                            <i class="bi bi-arrow-right me-1"></i>
                            <strong>{{ interaction.source_infrastructure }}</strong>
                            â†’
                            <strong>{{ interaction.target_infrastructure }}</strong>
                        </p>
                        
                        <p class="card-text">
                            {{ interaction.description[:100] }}
                            {% if interaction.description|length > 100 %}...{% endif %}
                        </p>
                        
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                <i class="bi bi-calendar3 me-1"></i>
                                {{ interaction.created_at.strftime('%Y-%m-%d') if interaction.created_at }}
                            </small>
                            
                            <span class="badge bg-primary">
                                {{ interaction.lifecycle_stage.title() }}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{{ url_for('view_interactions') }}" class="btn btn-outline-primary">
                <i class="bi bi-arrow-right me-2"></i>
                View All Interactions
            </a>
        </div>
    </div>
</div>
{% else %}
<!-- Empty State -->
<div class="row">
    <div class="col-12">
        <div class="text-center py-5">
            <i class="bi bi-inbox display-1 text-muted mb-4"></i>
            <h3 class="text-muted mb-3">No Interactions Yet</h3>
            <p class="text-muted mb-4">
                Get started by adding your first infrastructure interaction.
            </p>
            <a href="{{ url_for('add_interaction') }}" class="btn btn-primary btn-lg">
                <i class="bi bi-plus-circle me-2"></i>
                Add First Interaction
            </a>
        </div>
    </div>
</div>
{% endif %}

<!-- Information Section -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card bg-light">
            <div class="card-body">
                <h3 class="card-title">
                    <i class="bi bi-info-circle me-2"></i>
                    About This Tool
                </h3>
                <div class="row">
                    <div class="col-md-6">
                        <h5>Purpose</h5>
                        <p>
                            This application supports the MaLDReTH 2 Working Group meeting 
                            by collecting infrastructure interaction data across the research 
                            data lifecycle. The goal is to better understand how different 
                            pieces of research infrastructure interact with each other.
                        </p>
                    </div>
                    <div class="col-md-6">
                        <h5>Features</h5>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>Easy-to-use forms for data collection</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>CSV export for analysis and sharing</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>RESTful API for programmatic access</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Responsive design for all devices</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
